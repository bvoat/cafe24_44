<!--@layout(/layout/basic/layout.html)-->
<!--@css(/css/module/product/bvoat/best.css)-->
<!--@js(/js/count.js)-->
<article id="weekSocialOrderList" class="best_social_order_list">
    <section id="weekTotalBestList">
        <section id="weekTotalBestListTitle">
            <h1>주간 BEST ITEM</h1>
            <h2>한 주간 가장 많이 사랑 받은 상품입니다!</h2>
        </section>
        <div id="weekTotalBestListContents">
            <div class="weekbest" module="product_listmain_54">
                <!--
                    $count = 20
                    $basket_result = /product/add_basket.html
                    $basket_option = /product/basket_option.html
                -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
            </div>
            <!-- 더보기 모듈 기능 없음 -->
            <div class="paginate_moreview">
                <button class="moreview_btn">
                    순위 더 보기 <svg width="16" height="8" viewBox="0 0 16 8" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M0.932096 1.28632L0.850267 1.36201L0.934363 1.43518L7.93436 7.52512L8 7.58222L8.06564 7.52512L15.0656 1.43518L15.1497 1.36202L15.0679 1.28633L14.679 0.926592L14.6133 0.865783L14.5456 0.924434L8.00001 6.59786L1.4544 0.924434L1.38673 0.865784L1.321 0.92659L0.932096 1.28632Z"
                            fill="#022CFF" stroke="#022CFF" stroke-width="0.2" />
                    </svg>
                </button>
            </div>
            <!-- 더보기 모듈 기능 없음 -->
        </div>
    </section>
    <div id="weekTagBestList">
        <h2 class="displaynone">가치태그별 순위</h2>
        <section id="weekTagBestListTitle">
            <h1>지난 한 달간 사랑받았어요 🥰</h1>
            <h2>다른 보터들은 어떤 가치를 선택했을까요?</h2>
        </section>
        <div id="weekTagBestListContents">

            <!-- 가치태그 1위 -->
            <section id="tagRank1" class="weektag" module="product_listmain_54">
                <section id="weekTagTitle">
                    <h3 class="tag_title">
                        🗑 제로웨이스트
                        <a class="move_arrow" href="#" title="카테고리 이동"></a>
                    </h3>
                    <h4 class="tag_subtitle"><span class="purchasers"><em class="purchasers_num" data-num-ani-slow-point="0.2" data-num-ani-slow-add-interval="2" data-num-ani-interval="11" data-num-ani-stride="3" data-num-ani-start="0" data-num-ani-end="63"></em>명의 보터</span>가 <span
                        class="cate_item"><a href="#">🌵플라스틱 줄이기</a></span>
                    를 선택했어요.</h4>
                </section>
                <!--
                $count = 20
                $basket_result = /product/add_basket.html
                $basket_option = /product/basket_option.html
                -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
                <!-- 더보기 -->
                <div class="paginate_moreview">
                    <button class="moreview_btn" data-rank="1">
                        더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                    </button>
                </div>
                <!-- 더보기 -->
            </section>
            <!-- 가치태그 1위 -->
            <!-- 가치태그 2위 -->
            <section id="tagRank2" class="weektag" module="product_listmain_54">
                <section id="weekTagTitle">
                    <h3 class="tag_title">
                        🗑 제로웨이스트
                        <a class="move_arrow" href="#" title="카테고리 이동"></a>
                    </h3>
                    <h4 class="tag_subtitle"><span class="purchasers"><em class="purchasers_num" data-num-ani-slow-point="0.2" data-num-ani-slow-add-interval="2" data-num-ani-interval="11" data-num-ani-stride="3" data-num-ani-start="0" data-num-ani-end="63"></em>명의 보터</span>가 <span
                        class="cate_item"><a href="#">🌵플라스틱 줄이기</a></span>
                    를 선택했어요.</h4>
                </section>
                <!--
                $count = 20
                $basket_result = /product/add_basket.html
                $basket_option = /product/basket_option.html
                -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
                <!-- 더보기 -->
                <div class="paginate_moreview">
                    <button class="moreview_btn" data-rank="2">
                        더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                    </button>
                </div>
                <!-- 더보기 -->
            </section>
            <!-- 가치태그 2위 -->
            <!-- 가치태그 3위 -->
            <section id="tagRank3" class="weektag" module="product_listmain_54">
                <section id="weekTagTitle">
                    <h3 class="tag_title">
                        🗑 제로웨이스트
                        <a class="move_arrow" href="#" title="카테고리 이동"></a>
                    </h3>
                    <h4 class="tag_subtitle"><span class="purchasers"><em class="purchasers_num" data-num-ani-slow-point="0.2" data-num-ani-slow-add-interval="2" data-num-ani-interval="11" data-num-ani-stride="3" data-num-ani-start="0" data-num-ani-end="63"></em>명의 보터</span>가 <span
                        class="cate_item"><a href="#">🌵플라스틱 줄이기</a></span>
                    를 선택했어요.</h4>
                </section>
                <!--
                            $count = 20
                            $basket_result = /product/add_basket.html
                            $basket_option = /product/basket_option.html
                            -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
                <!-- 더보기 -->
                <div class="paginate_moreview">
                    <button class="moreview_btn" data-rank="3">
                        더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                    </button>
                </div>
                <!-- 더보기 -->
            </section>
            <!-- 가치태그 3위 -->
            <!-- 가치태그 4위 -->
            <section id="tagRank4" class="weektag" module="product_listmain_54">
                <section id="weekTagTitle">
                    <h3 class="tag_title">
                        🗑 제로웨이스트
                        <a class="move_arrow" href="#" title="카테고리 이동"></a>
                    </h3>
                    <h4 class="tag_subtitle"><span class="purchasers"><em class="purchasers_num" data-num-ani-slow-point="0.2" data-num-ani-slow-add-interval="2" data-num-ani-interval="11" data-num-ani-stride="3" data-num-ani-start="0" data-num-ani-end="63"></em>명의 보터</span>가 <span
                        class="cate_item"><a href="#">🌵플라스틱 줄이기</a></span>
                    를 선택했어요.</h4>
                </section>
                <!--
                $count = 20
                $basket_result = /product/add_basket.html
                $basket_option = /product/basket_option.html
                -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
                <!-- 더보기 -->
                <div class="paginate_moreview">
                    <button class="moreview_btn" data-rank="4">
                        더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                    </button>
                </div>
                <!-- 더보기 -->
            </section>
            <!-- 가치태그 4위 -->
            <!-- 가치태그 5위 -->
            <section id="tagRank5" class="weektag" module="product_listmain_54">
                <section id="weekTagTitle">
                    <h3 class="tag_title">
                        🗑 제로웨이스트
                        <a class="move_arrow" href="#" title="카테고리 이동"></a>
                    </h3>
                    <h4 class="tag_subtitle"><span class="purchasers"><em class="purchasers_num" data-num-ani-slow-point="0.2" data-num-ani-slow-add-interval="2" data-num-ani-interval="11" data-num-ani-stride="3" data-num-ani-start="0" data-num-ani-end="63"></em>명의 보터</span>가 <span
                        class="cate_item"><a href="#">🌵플라스틱 줄이기</a></span>
                    를 선택했어요.</h4>
                </section>
                <!--
                            $count = 20
                            $basket_result = /product/add_basket.html
                            $basket_option = /product/basket_option.html
                            -->
                <!--@import(/product/product_module/listmain/listmain.html)-->
                <!-- 더보기 -->
                <div class="paginate_moreview">
                    <button class="moreview_btn" data-rank="5">
                        더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                    </button>
                </div>
                <!-- 더보기 -->
            </section>
            <!-- 가치태그 5위 -->

        </div>
    </div>
</article>
<script>
    window.addEventListener("load", ()=>{
        NumAni__start('.purchasers_num');
    })
    /* 주간 베스트 더보기 클릭 */
    // 더보기 버튼
    const total_moreview = document.querySelector("#weekTotalBestListContents > .paginate_moreview > .moreview_btn")
    const totalBestShow = () => {
        // displaynone 상태의 list_item을 display flex로 변경
        [...document.querySelectorAll(".weekbest > ul > .list_item")].forEach((el) => {
            el.style.display = "flex"
        })
        // 더보기 버튼 삭제
        total_moreview.classList.add("displaynone");
    }
    total_moreview.addEventListener("click", totalBestShow);
    /* 주간 베스트 더보기 클릭 */

    /* 가치태그 베스트 더보기 클릭 */
    // 더보기 버튼
    //display none인 값 모을 배열
    let none_arr = [];
    [...document.querySelectorAll(".weektag > .paginate_moreview > .moreview_btn")].forEach((el) => {
        el.addEventListener("click", (e) => {
            //display none이 있는 상태에서의 이벤트
            console.log(document.querySelectorAll(`#tagRank${e.currentTarget.dataset.rank}`));
            //클릭한 버튼의 상품 리스트 clickTagListItem 만들기
            const clickTagListItem = document.querySelectorAll(`#tagRank${e.currentTarget.dataset.rank} > ul > li`);
            //더보기 끝났는지 체크 (item 중 display none인게 있는지 검사)
            if ([...clickTagListItem].filter((item) => { return window.getComputedStyle(item).display === 'none' }).length > 0) {
                //clickTagListItem 중 display가 none인 것 찾아서 4개 바꾸기
                clickTagListItem.forEach((item) => {
                    if (window.getComputedStyle(item).display === 'none') {
                        none_arr.push(item)
                    }
                })
                //index 0-3까지 4개의 상품 list flex로 변경
                for (let i = 0; i < 4; i++) {
                    none_arr[i].style.display = "flex";
                }
                //display none 값 가진 배열 초기화
                none_arr = [];
            } else {
                //display none이 남지 않은 접기 상태에서의 이벤트
                // 스크롤 올리기
                window.scroll({
                    behavior: 'smooth',
                    left: 0,
                    top: document.getElementById(`tagRank${e.currentTarget.dataset.rank}`).offsetTop - 110
                });
                // 다시 글자 & SVG 변경 (접기 -> 더 보기)
                [...e.currentTarget.childNodes].forEach((node) => { node.remove() })
                e.currentTarget.insertAdjacentHTML("beforeend", `
                더 보기
                        <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.932318 1.28394L0.849762 1.35984L0.93459 1.4332L7.93459 7.48629L8 7.54285L8.06541 7.48629L15.0654 1.4332L15.1502 1.35985L15.0677 1.28394L14.6788 0.926387L14.6133 0.866144L14.5459 0.924238L8.00001 6.56353L1.45417 0.924237L1.38674 0.866145L1.32122 0.926385L0.932318 1.28394Z"
                                fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2" />
                        </svg>
                `)
                // 4개 남기고 다 display none 상태로 변경
                for (i = 4; i < 20; i++) {
                    clickTagListItem[i].style.display = "none";
                }
            }
            //마지막 4개 내려올 때 버튼 내용 변경 (더 보기 -> 접기)
            if ([...clickTagListItem].filter((item) => { return window.getComputedStyle(item).display === 'none' }).length == 0) {
                //글자 & SVG 변경
                [...e.currentTarget.childNodes].forEach((node) => { node.remove() })
                e.currentTarget.insertAdjacentHTML("beforeend", `
                접기
                <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.0677 7.12719L15.1502 7.05129L15.0654 6.97793L8.06541 0.924843L8 0.868282L7.93459 0.924843L0.934591 6.97793L0.849764 7.05129L0.932316 7.12719L1.32119 7.48475L1.38672 7.54499L1.45415 7.48689L7.99999 1.8476L14.5458 7.4869L14.6133 7.54499L14.6788 7.48475L15.0677 7.12719Z" fill="#4B4B4B" stroke="#4B4B4B" stroke-width="0.2"/>
                </svg>
                `)
            }

        })
    })

</script>