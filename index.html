<!--@layout(/layout/basic/layout.html)-->
<!--@css(/layout/basic/css/index.css)-->
<!--@css(/layout/basic/css/aos.css)-->
<script src="/js/aos.js"></script>
<article id="bvtHome">
    <!--보터 카운트-->
    <section id="indexUserCnt" class="index_user">
        <div id="joinbanner" class="joinbanner"><span>🌞 </span> 비보트에서 <em class="membercnt"></em><em>명</em>이 가치소비를 함께하는
            중!
        </div>
    </section>
    <!--보터 카운트-->
    <!-- 메인 사각 배너 -->
    <!-- @import(/main/module/index_slide.html) -->

    <!-- 메인진열 섹션 -->
    <section id="indexListmain" class="index_list">
        <!-- 펀딩 -->
        <div id="listmainFunding" class="listmain">
            <h3>⏰ 진행 중인 펀딩<a class="listmain_arrow displaynone "></a></h3>
            <div class="list_contents_wrap right-side-control ">
                <div class="list_item_box one_img" module="product_listmain_18">
                    <!--
                        $count = 20
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/funding/module/funding_listmain.html)-->
                </div>
                <div class="swiper-pagination list_item_bullet"></div>
            </div>
        </div>
        <!-- 새로 입점된 브랜드  -->
        <div id="listmainBrand" class="listmain">
            <h3>🏡 새로 입점된 브랜드<a class="listmain_arrow displaynone"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box brand">
                    <ul class="swiper-wrapper">
                        <li class="swiper-slide list_item"><a href="/minishop/fxng"><img
                                    src="/bvtIMG/banner/newbrand/fxng.png" alt="브랜드 퐁 미니샵 바로가기"></a></li>
                        <li class="swiper-slide list_item"><a href="/minishop/thereed"><img
                                    src="/bvtIMG/banner/newbrand/thereed.png" alt="브랜드 더리드 미니샵 바로가기"></a></li>
                        <li class="swiper-slide list_item"><a href="/minishop/zblack"><img
                                    src="/bvtIMG/banner/newbrand/zblack.png" alt="브랜드 지블랙 미니샵 바로가기"></a></li>
                        <li class="swiper-slide list_item"><a href="/minishop/rebud"><img
                                    src="/bvtIMG/banner/newbrand/rebud.png" alt="브랜드 리버드 미니샵 바로가기"></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- 주간 베스트 -->
        <div id="listmainTopValue" class="listmain">
            <h3>👍 비보트 주간 BEST<a class="listmain_arrow displaynone"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box best weekbest" module="product_listmain_226">
                    <!--
                        $count = 10
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/product/product_module/listmain/listmain.html)-->
                </div>
            </div>
        </div>
        <!-- 테마 -->
        <div id="listmainTheme_1" class="listmain listmain_pagination" module="product_listmain_227">
            <h3>{$category_title_text}<a href="/product/list.html?cate_no=1018" class="listmain_arrow"
                    title="{$category_title_text}"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box listmain_theme">
                    <!--
                        $count = 30
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/product/product_module/listmain/listmain.html)-->
                </div>
            </div>
        </div>
        <!-- 테마 -->
        <div id="listmainTheme_2" class="listmain listmain_pagination" module="product_listmain_228">
            <h3>{$category_title_text}<a href="/product/list.html?cate_no=627" class="listmain_arrow"
                    title="{$category_title_text}"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box listmain_theme">
                    <!--
                        $count = 30
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/product/product_module/listmain/listmain.html)-->
                </div>
            </div>
        </div>
        <!-- 테마 -->
        <div id="listmainTheme_3" class="listmain listmain_pagination" module="product_listmain_229">
            <h3>{$category_title_text}<a href="/product/list.html?cate_no=662" class="listmain_arrow"
                    title="{$category_title_text}"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box listmain_theme">
                    <!--
                        $count = 30
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/product/product_module/listmain/listmain.html)-->
                </div>
            </div>
        </div>
        <!-- 테마 -->
        <div id="listmainTheme_4" class="listmain listmain_pagination" module="product_listmain_230">
            <h3>{$category_title_text}<a href="/product/list.html?cate_no=1074" class="listmain_arrow"
                    title="{$category_title_text}"></a></h3>
            <div class="list_contents_wrap">
                <div class="list_item_box listmain_theme">
                    <!--
                        $count = 30
                        $basket_result = /product/add_basket.html
                        $basket_option = /product/basket_option.html
                    -->
                    <!--@import(/product/product_module/listmain/listmain.html)-->
                </div>
            </div>
        </div>
        <!--@import(/main/module/board_8.html)-->
    </section>
    <!-- 메인진열 섹션 -->
    <!--@layout(/layout/basic/layout.html)-->
</article>
<!--@import(/layout/basic/footer.html)-->
<!--@define(cmc_log)-->
<script src="/layout/basic/js/index.js"></script>
<!-- AOS 초기화 -->
<script>
    AOS.init();
    /* 슬라이더 */
    // 상단 배너 슬라이드
    var swiper = new Swiper("#indexSquareBanner", {
        slidesPerView: 1,
        spaceBetween: 0,
        loop: true,
        autoplay: {
            delay: 3500,
            disableOnInteraction: false,
        },
    });
    // Funding 메인진열 슬라이드
    var swiper = new Swiper(".one_img", {
        slidesPerView: 1,
        spaceBetween: 0,
        pagination: {
            el: ".list_item_bullet",
            clickable: true,
        },
    });
    // Brand 메인진열 슬라이드
    var swiper = new Swiper(".brand", {
        slidesPerView: 2.16168,
        spaceBetween: 10,
    });
    // 재구매
    var swiper = new Swiper(".best", {
        slidesPerView: 2.2227,
        spaceBetween: 10,
    });
    // 테마
    var swiper = new Swiper(".listmain_theme", {
        slidesPerView: 1.7,
        spaceBetween: 10,
        freeMode: {
            enabled: true,
            minimumVelocity: 2,
            momentumBounceRatio: 0.1,
            momentumRatio: 0.5,
            momentumVelocityRatio: 0.5,
        },
    });
</script>
<script>


    //나머지 노드 찾기
    const getSibiling = (nodearray, btn) => {
        return nodearray && [...nodearray].filter(node => node != btn);
    }

    /* 더보기 세팅 */
    const moreview_listmain = document.querySelectorAll(".moreview .prdList");
    //초기 로딩 시 4개 제외하고 모두 displaynone 처리
    const hideMoreview = () => {
        moreview_listmain.forEach(list => {
            [...list.children].forEach((item, i) => {
                i > 3 ?
                    item.classList.add("displaynone") :
                    null;

            });
        });
    };

    /* 더보기 버튼 */
    //display none인 값 모을 배열
    let none_arr = [];
    const clickMoreviewBtn = () => {
        const moreviewBtn = document.querySelectorAll(".moreview_btn");
        moreviewBtn.forEach(el => {
            el.addEventListener("click", (e) => {
                //display none이 있는 상태에서의 이벤트
                const buttonClass = e.currentTarget.dataset.btn;
                const selectList = document.querySelector(`.list_item_box.${buttonClass}>.prdList`);

                //더보기 끝났는지 체크 (item 중 display none인게 있는지 검사)
                const clickListItem = selectList.children;
                if ([...clickListItem].filter((item) => { return window.getComputedStyle(item).display === 'none' }).length != 0) {
                    //clickTagListItem 중 display가 none인 것 찾아서 4개 바꾸기
                    [...clickListItem].forEach((item) => {
                        if (window.getComputedStyle(item).display === 'none') {
                            none_arr.push(item);
                        }
                    });
                    console.log('none_arr: ', none_arr.length);

                    if (none_arr.length > 4) {
                        //index 0-3까지 4개의 상품 list flex로 변경
                        for (let i = 0; i < 4; i++) {
                            none_arr[i].classList.remove("displaynone");
                        }
                        //display none 값 가진 배열 초기화
                        none_arr = [];
                    } else if (none_arr.length < 4) {
                        console.log("none_arr", none_arr)
                        none_arr.forEach(item => {
                            item.classList.remove("displaynone");
                        });
                        //더보기 버튼 삭제
                        e.currentTarget.classList.add("displaynone");
                    }
                } else {
                    //더보기 버튼 삭제
                    e.currentTarget.classList.add("displaynone");
                }
            })
        })
    }
    window.addEventListener("DOMContentLoaded", () => {
        hideMoreview();
        clickMoreviewBtn();
    })



    /* 최종 실행 */
    // window.addEventListener("DOMContentLoaded", () => {
    //     [...recommendBtnArray].forEach((btn) => {
    //         btn.addEventListener("click", clickChangeRecommendListmainButton);
    //     });
    // })
    // window.addEventListener("DOMContentLoaded", () => {
    //     [...freedeliveryBtnArray].forEach((btn) => {
    //         btn.addEventListener("click", clickChangeFreeDeliveryListmainButton);
    //     });
    // })
    /* 최종 실행 */

</script>