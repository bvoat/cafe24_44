on: push
name: üöÄ Deploy Bvoat on push from web to mobile
jobs:
  web-deploy:
    name: üéâ Deploy
    runs-on: ubuntu-latest
    timeout-minutes: 1000
    steps:
    - name: üöö Get latest code
      uses: actions/checkout@v2

    - name: üìÇ Sync files mobile21
      uses: SamKirkland/FTP-Deploy-Action@4.3.0
      with:
        server: ${{ secrets.ACTION_FTP_HOST }}
        server-dir: /sde_design/mobile21/
        username: bvoatofficial
        password: ${{ secrets.ACTION_FTP_PWD }}
        protocol: ftp
        port: 21
        exclude: |
          **/.git*
          **/.git*/**
          **/node_modules/**
          **/.github*
          **/.github*/**
          **/preference*
          **/preference*/**
          *.json
          *.ini
          *.gif
          *.yml
          *.scss
          *.css.map

    - name: üìÇ Sync files skin45
      uses: SamKirkland/FTP-Deploy-Action@4.3.0
      with:
        server: ${{ secrets.ACTION_FTP_HOST }}
        server-dir: /sde_design/skin45/
        username: bvoatofficial
        password: ${{ secrets.ACTION_FTP_PWD }}
        protocol: ftp
        port: 21
        exclude: |
          **/.git*
          **/.git*/**
          **/node_modules/**
          **/.github*
          **/.github*/**
          **/preference*
          **/preference*/**
          *.json
          *.ini
          *.gif
          *.yml
          *.scss
          *.css.map
          
    - name: Send FTP Result data to Passengers Slack 
      id: slack
      uses: slackapi/slack-github-action@v1.18.0
      with:
        # For posting a rich message using Block Kit
        payload: |
          {
            "text": "*[Ïπ¥Ìéò24 GitHub Action Î∞∞Ìè¨üöÄ]*",
            "blocks": [
              {
                "type": "section",
                "text": {
                  "type": "mrkdwn",
                  "text": "* \n\n ${{github.event.workflow_run.name}}\n *GitHub Action Ïã§Ìñâ Í≤∞Í≥º : * ${{ job.status }}\n \n *Pushed by : * ${{ github.event.sender.login }} ${{ github.event.pull_request.user.login }}"
                }
              },
              {
                "type": "button",
                "text": {
                  "type": "plain_text",
                  "text": "Repo Link"
                },
                "url": "${{ github.event.pull_request.html_url || github.event.head_commit.url }}"
              }
            ]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.ACTION_SLACK_WEBHOOK_URL }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK
